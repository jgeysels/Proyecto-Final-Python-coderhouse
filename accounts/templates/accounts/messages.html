{% extends 'base_generic.html' %}

{% block content %}
    <h1>Mensajes</h1>

    <div>
        <h3>Usuarios:</h3>
        <ul>
            {% for user in users %}
                <li><a href="{% url 'messages' %}?chat_user={{ user.id }}">{{ user.username }}</a></li>
            {% endfor %}
        </ul>
    </div>

    <div>
        {% if chat_user %}
            <h3>Chat con {{ chat_user.username }}</h3>
            <div>
                {% for message in messages %}
                    <p>
                        <strong>{{ message.sender.username }}:</strong> {{ message.content }}
                    </p>
                {% empty %}
                    <p>No hay mensajes.</p>
                {% endfor %}
            </div>
            <form method="POST" action="">
                {% csrf_token %}
                {{ form.receiver.as_hidden }}
                {{ form.content }}
                <button type="submit">Enviar mensaje</button>
            </form>
        {% else %}
            <p>Selecciona un usuario para comenzar una conversaci√≥n.</p>
        {% endif %}
    </div>
{% endblock %}

